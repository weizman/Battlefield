<html>
<head>
    <script>exports = {};module = {};</script>
    <script src="https://cdn.jsdelivr.net/npm/content-security-policy-parser" integrity="sha512-7Z0pYUIlIx7uvWwSYwJkzBVff8Rc03r5J/jr+Zf5WCsusk0UfuGnQA1lk+DrvpI8kbj4wm6Hmlqx2tZ0oULN5w==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/content-security-policy-builder" integrity="sha512-sYGkSZ+4+shnkEvNlTfz3Wlp983VcgkgcQ675cBwrJeIdbgwiwA0weN4xyQwOzWVxGfzMaRrb6rsR1tXKoc1PQ==" crossorigin="anonymous"></script>
    <script>buildContentSecurityPolicy = module.exports</script>
    <script>parseContentSecurityPolicy = top.parseContentSecurityPolicy</script>
    <script src="storage.js"></script>
    <script src="params.js"></script>
    <script src="components.js"></script>
    <script>document.addEventListener('DOMContentLoaded', () => initUI(state, container, 17))</script>
    <script>document.write(`<script>${config.xss}</scr`+`ipt>`)</script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            reset_container.replaceWith(reset(true));
            save_container.replaceWith(save());
            load_container.replaceWith(load());
            share_container.replaceWith(share());
            script_container.replaceWith(script());
            iframe_container.replaceWith(frame());
        });
    </script>
    <script>
        const directives = [
            'default-src',
            'script-src',
            'style-src',
            'img-src',
            'connect-src',
            'font-src',
            'object-src',
            'media-src',
            'frame-src',
            'child-src',
            'worker-src',
            'script-src-elem',
            'style-src-elem',
            'script-src-attr',
            'style-src-attr',
            'frame-ancestors',
            'form-action',
            'navigate-to',
            'base-uri',
            'manifest-src',
            'sandbox',
            'report-uri',
            'report-to',
            'block-all-mixed-content',
            'upgrade-insecure-requests',
            'plugin-types',
            'require-sri-for',
            'trusted-types',
            'require-trusted-types-for',
        ];

        const state = Object.assign(directives.reduce((obj, key) => {
            obj[key] = [];
            return obj;
        }, {}), config.csp);

        (function(){
            const directivesNonEmpty = structuredClone(state);
            for (const d in directivesNonEmpty) {
                if (!directivesNonEmpty[d].length) {
                    delete directivesNonEmpty[d];
                }
            }
            const csp = buildContentSecurityPolicy({
                directives: directivesNonEmpty,
            });
            document.write(`<meta http-equiv="Content-Security-Policy" content="${csp}">`)
        }())
    </script>
</head>
<body>
    <h1>
        <a href="https://weizmangal.com/Battlefield">Battlefield</a> ⚔️
        <div id="reset_container"></div>
        <div id="share_container"></div>
        <div id="save_container"></div>
        <div id="load_container"></div>
    </h1>
    <div>
        <li>
            <i>
                <b>Pro Tip: </b>type
                <div id="script_container"></div> or
                <div id="iframe_container"></div> to generate <code>src</code>s to scripts/iframes that dynamically execute code you dictate
            </i>
        </li>
    </div>
    <br>
    <div id="container"></div>
    <br>
    <span><i>~ <a href="https://github.com/weizman/Battlefield">https://github.com/weizman/Battelfield</a></i></span>
</body>
</html>